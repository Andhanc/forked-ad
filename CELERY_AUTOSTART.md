# üîÑ –ê–í–¢–û–ó–ê–ü–£–°–ö CELERY

## ‚ùì –ù—É–∂–Ω–æ –ª–∏ –∑–∞–ø—É—Å–∫–∞—Ç—å Celery –≤—Ä—É—á–Ω—É—é?

**–ù–ï–¢!** –ï—Å—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–ø–æ—Å–æ–±–æ–≤ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏.

---

## üéØ –í–ê–†–ò–ê–ù–¢–´ (–æ—Ç –ª—É—á—à–µ–≥–æ –∫ —Ö—É–¥—à–µ–º—É)

---

## ‚úÖ –í–ê–†–ò–ê–ù–¢ 1: Docker Compose (–õ–£–ß–®–ò–ô)

### –ß—Ç–æ —ç—Ç–æ?
–ó–∞–ø—É—Å–∫–∞–µ—Ç **–í–°–Å** –æ–¥–Ω–æ–π –∫–æ–º–∞–Ω–¥–æ–π:
- PostgreSQL
- Redis
- Django
- **Celery** ‚Üê –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏!
- Flower (–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥)

### –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:

```powershell
# –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å—ë
docker compose up -d

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å
docker compose ps

# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤—Å—ë
docker compose down
```

### –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:
- ‚úÖ –û–¥–Ω–∞ –∫–æ–º–∞–Ω–¥–∞ –¥–ª—è –≤—Å–µ–≥–æ
- ‚úÖ –ê–≤—Ç–æ–ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ –ø—Ä–∏ —Å–±–æ—è—Ö
- ‚úÖ Production-ready
- ‚úÖ –ò–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ
- ‚úÖ –õ–µ–≥–∫–æ —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—å –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

### –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:
- üöÄ **Production** (—Ä–∞–±–æ—á–∏–π —Å–µ—Ä–≤–µ—Ä)
- üì¶ **Deployment** (—Ä–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏–µ)
- üß™ **–ü–æ–ª–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**

---

## ‚úÖ –í–ê–†–ò–ê–ù–¢ 2: BAT-—Ñ–∞–π–ª + Task Scheduler

### –®–∞–≥ 1: –°–æ–∑–¥–∞–Ω —Ñ–∞–π–ª `start_celery.bat`

–£–∂–µ —Å–æ–∑–¥–∞–Ω –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞! –ü—Ä–æ—Å—Ç–æ **–¥–≤–æ–π–Ω–æ–π –∫–ª–∏–∫** –¥–ª—è –∑–∞–ø—É—Å–∫–∞.

### –®–∞–≥ 2: –î–æ–±–∞–≤–∏—Ç—å –≤ –∞–≤—Ç–æ–∑–∞–≥—Ä—É–∑–∫—É Windows

**–ß–µ—Ä–µ–∑ Task Scheduler:**

1. **–û—Ç–∫—Ä–æ–π—Ç–µ:** `Win+R` ‚Üí `taskschd.msc`
2. **–°–æ–∑–¥–∞—Ç—å –∑–∞–¥–∞—á—É** ‚Üí "Create Basic Task"
3. **–ò–º—è:** "Celery Worker Plagiarism"
4. **–¢—Ä–∏–≥–≥–µ—Ä:** "When I log on" (–ø—Ä–∏ –≤—Ö–æ–¥–µ –≤ —Å–∏—Å—Ç–µ–º—É)
5. **–î–µ–π—Å—Ç–≤–∏–µ:** "Start a program"
6. **–ü—Ä–æ–≥—Ä–∞–º–º–∞:** `C:\allcodes\ad\start_celery.bat`
7. **–ì–æ—Ç–æ–≤–æ!**

–¢–µ–ø–µ—Ä—å Celery –∑–∞–ø—É—Å—Ç–∏—Ç—Å—è **–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏** –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ Windows.

### –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:
- ‚úÖ –ê–≤—Ç–æ–∑–∞–ø—É—Å–∫ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ —Å–∏—Å—Ç–µ–º—ã
- ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç –≤ —Ñ–æ–Ω–µ
- ‚úÖ –ù–µ –Ω—É–∂–µ–Ω Docker

### –ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏:
- ‚ö†Ô∏è Redis –Ω—É–∂–Ω–æ –∑–∞–ø—É—Å–∫–∞—Ç—å –æ—Ç–¥–µ–ª—å–Ω–æ
- ‚ö†Ô∏è Django –Ω—É–∂–Ω–æ –∑–∞–ø—É—Å–∫–∞—Ç—å –æ—Ç–¥–µ–ª—å–Ω–æ
- ‚ö†Ô∏è –ú–µ–Ω–µ–µ –Ω–∞–¥—ë–∂–Ω–æ —á–µ–º Docker

---

## ‚úÖ –í–ê–†–ò–ê–ù–¢ 3: Windows Service (NSSM)

### –ß—Ç–æ —ç—Ç–æ?
–ü—Ä–µ–≤—Ä–∞—â–∞–µ—Ç Celery –≤ **Windows —Å–ª—É–∂–±—É** (–∫–∞–∫ –∞–Ω—Ç–∏–≤–∏—Ä—É—Å).

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ NSSM:

```powershell
# –ß–µ—Ä–µ–∑ Chocolatey
choco install nssm

# –ò–ª–∏ —Å–∫–∞—á–∞—Ç—å: https://nssm.cc/download
```

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞:

```powershell
# –°–æ–∑–¥–∞—Ç—å —Å–ª—É–∂–±—É
nssm install CeleryWorker "C:\allcodes\ad\.venv\Scripts\celery.exe"

# –ü–∞—Ä–∞–º–µ—Ç—Ä—ã
nssm set CeleryWorker AppParameters "-A app worker --loglevel=info --pool=solo"
nssm set CeleryWorker AppDirectory "C:\allcodes\ad\Folder"

# –ó–∞–ø—É—Å—Ç–∏—Ç—å
nssm start CeleryWorker
```

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:

```powershell
# –°—Ç–∞—Ç—É—Å
nssm status CeleryWorker

# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å
nssm stop CeleryWorker

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å
nssm restart CeleryWorker

# –£–¥–∞–ª–∏—Ç—å —Å–ª—É–∂–±—É
nssm remove CeleryWorker
```

### –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:
- ‚úÖ –ó–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ Windows
- ‚úÖ –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ –ø—Ä–∏ —Å–±–æ—è—Ö
- ‚úÖ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ Services.msc
- ‚úÖ –õ–æ–≥–∏ –≤ —Ñ–∞–π–ª

### –ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏:
- ‚ö†Ô∏è –°–ª–æ–∂–Ω–µ–µ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å
- ‚ö†Ô∏è Redis/Django –æ—Ç–¥–µ–ª—å–Ω–æ

---

## ‚úÖ –í–ê–†–ò–ê–ù–¢ 4: Supervisor (—Ç–æ–ª—å–∫–æ Linux)

–ï—Å–ª–∏ —Ä–∞–∑–≤–æ—Ä–∞—á–∏–≤–∞–µ—Ç–µ –Ω–∞ Linux —Å–µ—Ä–≤–µ—Ä–µ:

```bash
# /etc/supervisor/conf.d/celery.conf
[program:celery]
command=/path/to/venv/bin/celery -A app worker --loglevel=info
directory=/path/to/project/Folder
user=www-data
autostart=true
autorestart=true
redirect_stderr=true
stdout_logfile=/var/log/celery.log
```

```bash
# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å
sudo supervisorctl reread
sudo supervisorctl update
sudo supervisorctl start celery
```

---

## ‚úÖ –í–ê–†–ò–ê–ù–¢ 5: Systemd (—Ç–æ–ª—å–∫–æ Linux)

```bash
# /etc/systemd/system/celery.service
[Unit]
Description=Celery Worker
After=network.target

[Service]
Type=forking
User=www-data
Group=www-data
WorkingDirectory=/path/to/project/Folder
ExecStart=/path/to/venv/bin/celery -A app worker --loglevel=info --detach
Restart=always

[Install]
WantedBy=multi-user.target
```

```bash
sudo systemctl daemon-reload
sudo systemctl enable celery
sudo systemctl start celery
```

---

## üéØ –ö–ê–ö–û–ô –í–´–ë–†–ê–¢–¨?

### –î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ (–ª–æ–∫–∞–ª—å–Ω–æ):
```
1. –ù–ï –∑–∞–ø—É—Å–∫–∞—Ç—å Celery –≤–æ–æ–±—â–µ (—Ä–∞–±–æ—Ç–∞–µ—Ç —á–µ—Ä–µ–∑ fallback)
2. –ó–∞–ø—É—Å–∫–∞—Ç—å –≤—Ä—É—á–Ω—É—é –∫–æ–≥–¥–∞ –Ω—É–∂–Ω–æ (–¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Å–∫–æ—Ä–æ—Å—Ç–∏)
3. BAT-—Ñ–∞–π–ª (–¥–≤–æ–π–Ω–æ–π –∫–ª–∏–∫)
```

### –î–ª—è production (—Å–µ—Ä–≤–µ—Ä):
```
1. Docker Compose ‚úÖ (—Å–∞–º—ã–π –ø—Ä–æ—Å—Ç–æ–π –∏ –Ω–∞–¥—ë–∂–Ω—ã–π)
2. Systemd (–µ—Å–ª–∏ Linux –±–µ–∑ Docker)
3. Supervisor (–µ—Å–ª–∏ –Ω—É–∂–Ω—ã —Å–ª–æ–∂–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏)
```

### –î–ª—è Windows (–ª–æ–∫–∞–ª—å–Ω—ã–π —Å–µ—Ä–≤–µ—Ä):
```
1. Docker Compose ‚úÖ
2. NSSM (Windows Service)
3. Task Scheduler
```

---

## üìä –°–†–ê–í–ù–ï–ù–ò–ï

| –ú–µ—Ç–æ–¥ | –ê–≤—Ç–æ–∑–∞–ø—É—Å–∫ | –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ | –°–ª–æ–∂–Ω–æ—Å—Ç—å | –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è |
|-------|------------|------------|-----------|--------------|
| **Docker Compose** | ‚úÖ | ‚úÖ | –ù–∏–∑–∫–∞—è | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê Production |
| **Task Scheduler** | ‚úÖ | ‚ùå | –°—Ä–µ–¥–Ω—è—è | ‚≠ê‚≠ê‚≠ê Development |
| **NSSM** | ‚úÖ | ‚úÖ | –°—Ä–µ–¥–Ω—è—è | ‚≠ê‚≠ê‚≠ê‚≠ê Windows Server |
| **–í—Ä—É—á–Ω—É—é** | ‚ùå | ‚ùå | –ù–∏–∑–∫–∞—è | ‚≠ê‚≠ê Testing |
| **Systemd** | ‚úÖ | ‚úÖ | –°—Ä–µ–¥–Ω—è—è | ‚≠ê‚≠ê‚≠ê‚≠ê Linux Server |

---

## üé¨ –ß–¢–û –î–ï–õ–ê–¢–¨ –°–ï–ô–ß–ê–°?

### –î–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏:
```powershell
# –í–∞—Ä–∏–∞–Ω—Ç –ê: –í–æ–æ–±—â–µ –Ω–µ –∑–∞–ø—É—Å–∫–∞—Ç—å (—Ä–∞–±–æ—Ç–∞–µ—Ç –º–µ–¥–ª–µ–Ω–Ω–æ, –Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç)
python manage.py runserver

# –í–∞—Ä–∏–∞–Ω—Ç –ë: –î–≤–æ–π–Ω–æ–π –∫–ª–∏–∫ –Ω–∞ start_celery.bat (–∫–æ–≥–¥–∞ –Ω—É–∂–Ω–∞ —Å–∫–æ—Ä–æ—Å—Ç—å)
# –ò–ª–∏ –ø—Ä–æ—Å—Ç–æ –∫–æ–º–∞–Ω–¥–∞ –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ:
cd C:\allcodes\ad\Folder
celery -A app worker --loglevel=info --pool=solo
```

### –î–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞:
```powershell
# –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Docker Compose ‚úÖ
docker compose up -d

# –í—Å—ë –∑–∞–ø—É—Å—Ç–∏—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏!
```

---

## ‚ùì –ß–ê–°–¢–û –ó–ê–î–ê–í–ê–ï–ú–´–ï –í–û–ü–†–û–°–´

### Q: –ß—Ç–æ –µ—Å–ª–∏ –∑–∞–±—É–¥—É –∑–∞–ø—É—Å—Ç–∏—Ç—å Celery?
**A:** –ù–∏—á–µ–≥–æ —Å—Ç—Ä–∞—à–Ω–æ–≥–æ! –°–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ fallback —Ä–µ–∂–∏–º–µ (—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ, –º–µ–¥–ª–µ–Ω–Ω–æ).

### Q: Celery —É–ø–∞–ª, —á—Ç–æ –¥–µ–ª–∞—Ç—å?
**A:** 
- **Docker:** `docker compose restart celery`
- **–í—Ä—É—á–Ω—É—é:** –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –∫–æ–º–∞–Ω–¥–æ–π
- **NSSM:** `nssm restart CeleryWorker`

### Q: –ö–∞–∫ —É–∑–Ω–∞—Ç—å —á—Ç–æ Celery —Ä–∞–±–æ—Ç–∞–µ—Ç?
**A:**
```powershell
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—Ä–æ—Ü–µ—Å—Å—ã
celery -A app inspect active

# –ò–ª–∏ —á–µ—Ä–µ–∑ Flower
http://localhost:5555
```

### Q: –ù—É–∂–µ–Ω –ª–∏ Celery –¥–ª—è –º–∞–ª–µ–Ω—å–∫–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞?
**A:** –ù–µ—Ç! –î–ª—è <10 –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤/–¥–µ–Ω—å –º–æ–∂–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å –±–µ–∑ Celery (—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ).

### Q: Celery —Å—ä–µ–¥–∞–µ—Ç –º–Ω–æ–≥–æ –ø–∞–º—è—Ç–∏?
**A:** 
- –û–¥–∏–Ω worker: ~150-300 MB RAM
- Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä: ~200-400 MB RAM
- –î–ª—è 4-8 –≤–æ—Ä–∫–µ—Ä–æ–≤: ~500 MB - 1 GB RAM

---

## üîß –ú–û–ù–ò–¢–û–†–ò–ù–ì

### –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ Celery —Ä–∞–±–æ—Ç–∞–µ—Ç:

```powershell
# –ê–∫—Ç–∏–≤–Ω—ã–µ –∑–∞–¥–∞—á–∏
celery -A app inspect active

# –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
celery -A app inspect stats

# –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏
celery -A app inspect registered
```

### Flower (–≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å):
```powershell
celery -A app flower --port=5555
# –û—Ç–∫—Ä–æ–π—Ç–µ: http://localhost:5555
```

---

## üéâ –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–Ø

### –î–õ–Ø –í–ê–° (—Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞):

**–°–µ–π—á–∞—Å:**
1. –û—Å—Ç–∞–≤—å—Ç–µ Celery –∑–∞–ø—É—â–µ–Ω–Ω—ã–º –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ (—É–∂–µ —Ä–∞–±–æ—Ç–∞–µ—Ç ‚úÖ)
2. –ü—Ä–∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–µ —Å–∏—Å—Ç–µ–º—ã –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `start_celery.bat`

**–í –±—É–¥—É—â–µ–º (–ø—Ä–æ–¥–∞–∫—à–µ–Ω):**
```powershell
docker compose up -d
```

–ì–æ—Ç–æ–≤–æ! –ë–æ–ª—å—à–µ –≤—Ä—É—á–Ω—É—é –Ω–∏—á–µ–≥–æ –Ω–µ –Ω—É–∂–Ω–æ! üöÄ

---

## üìù –ò–¢–û–ì

Celery –ù–ï –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –∑–∞–ø—É—Å–∫–∞—Ç—å –∫–∞–∂–¥—ã–π —Ä–∞–∑ –≤—Ä—É—á–Ω—É—é:
- ‚úÖ Docker Compose - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
- ‚úÖ Task Scheduler - –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ Windows
- ‚úÖ NSSM - –∫–∞–∫ —Å–ª—É–∂–±–∞ Windows
- ‚úÖ BAT-—Ñ–∞–π–ª - –¥–≤–æ–π–Ω–æ–π –∫–ª–∏–∫

**–í—ã–±–∏—Ä–∞–π—Ç–µ —á—Ç–æ —É–¥–æ–±–Ω–µ–µ!** üéØ
