# ‚úÖ –°—Ç–∞—Ç—É—Å Redis –≤ –ø—Ä–æ–µ–∫—Ç–µ

## üü¢ Redis –†–ê–ë–û–¢–ê–ï–¢ –∏ –ò–°–ü–û–õ–¨–ó–£–ï–¢–°–Ø!

### –ì–¥–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è Redis:

#### 1. **Celery Message Broker** 
- –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –Ω–∞ –ø–ª–∞–≥–∏–∞—Ç
- –û—á–µ—Ä–µ–¥—å –∑–∞–¥–∞—á –¥–ª—è —Ñ–æ–Ω–æ–≤–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏
- –ü—É—Ç—å: `redis://localhost:6379/0`

#### 2. **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–µ–∫—Ç–æ—Ä–æ–≤ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤**
- –£—Å–∫–æ—Ä—è–µ—Ç –ø–æ–≤—Ç–æ—Ä–Ω—É—é –æ–±—Ä–∞–±–æ—Ç–∫—É
- TTL: 1 —á–∞—Å (3600 —Å–µ–∫)
- –§–æ—Ä–º–∞—Ç –∫–ª—é—á–∞: `vector:{document_id}`

#### 3. **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è**
- –°–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å—Ö–æ–∂–µ—Å—Ç–∏ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
- TTL: 2 —á–∞—Å–∞ (7200 —Å–µ–∫)
- –§–æ—Ä–º–∞—Ç –∫–ª—é—á–∞: `similarity:{doc1_id}:{doc2_id}`

---

## –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ Redis

### –ß–µ—Ä–µ–∑ Docker:
```bash
docker ps --filter "name=redis"
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
```
NAMES     STATUS         PORTS
redis     Up X minutes   0.0.0.0:6379->6379/tcp
```

### –ß–µ—Ä–µ–∑ Python:
```bash
cd Folder
..\.venv\Scripts\python.exe -c "import redis; r = redis.Redis(host='localhost', port=6379, db=0); print('Redis ping:', r.ping())"
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
```
Redis ping: True
```

---

## Graceful Degradation (–ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ –æ—Ç–∫–ª—é—á–µ–Ω–∏–µ)

–ï—Å–ª–∏ Redis –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω, —Å–∏—Å—Ç–µ–º–∞ **–ù–ï –£–ü–ê–î–Å–¢**:
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –ø–µ—Ä–µ–∫–ª—é—á–∏—Ç—Å—è –Ω–∞ **—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π —Ä–µ–∂–∏–º**
- –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –±—É–¥–µ—Ç –æ—Ç–∫–ª—é—á–µ–Ω–æ
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–≤–∏–¥–∏—Ç –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ: "Redis –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω, –æ–±—Ä–∞–±–æ—Ç–∫–∞ –≤ —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–º —Ä–µ–∂–∏–º–µ (–∑–∞–π–º—ë—Ç 30-60 —Å–µ–∫)..."

**–ö–æ–¥ –≤** `Folder/documents/views.py`:
```python
try:
    process_document_plagiarism.delay(document.id)  # Celery (async)
    messages.success(request, '–î–æ–∫—É–º–µ–Ω—Ç –∑–∞–≥—Ä—É–∂–µ–Ω –∏ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω –Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫—É')
except Exception:
    # Fallback: —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞
    result = process_document_sync(document.id)
    messages.success(request, f'–î–æ–∫—É–º–µ–Ω—Ç –æ–±—Ä–∞–±–æ—Ç–∞–Ω. –û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ—Å—Ç—å: {result["originality"]}%')
```

---

## –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ Redis –≤ –ø—Ä–æ–µ–∫—Ç–µ

| –§—É–Ω–∫—Ü–∏—è | –ë–µ–∑ Redis | –° Redis |
|---------|-----------|---------|
| **–û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞** | 30-60 —Å–µ–∫ (–±–ª–æ–∫–∏—Ä—É–µ—Ç —Å—Ç—Ä–∞–Ω–∏—Ü—É) | –ú–≥–Ω–æ–≤–µ–Ω–Ω–æ (—Ñ–æ–Ω) |
| **–ü–æ–≤—Ç–æ—Ä–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞** | –ü–æ–ª–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ (~60 —Å–µ–∫) | –ò–∑ –∫—ç—à–∞ (~1 —Å–µ–∫) |
| **–°—Ä–∞–≤–Ω–µ–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤** | –ö–∞–∂–¥—ã–π —Ä–∞–∑ –∑–∞–Ω–æ–≤–æ | –ö—ç—à–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç |
| **–ù–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä** | –í—ã—Å–æ–∫–∞—è (—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ) | –ù–∏–∑–∫–∞—è (—Ä–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–∞—è) |

---

## –õ–æ–≥–∏ Redis

### –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ (–≤ –∫–æ–¥–µ –ø—Ä–æ–µ–∫—Ç–∞):
```python
from documents.utils_cache import get_redis_client

client = get_redis_client()
if client:
    print("‚úÖ Redis –¥–æ—Å—Ç—É–ø–µ–Ω")
else:
    print("‚ùå Redis –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω")
```

### –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞:
```bash
docker logs redis
```

---

## –†–µ–∑—é–º–µ

‚úÖ **Redis –∑–∞–ø—É—â–µ–Ω** –≤ Docker –Ω–∞ –ø–æ—Ä—Ç—É `6379`  
‚úÖ **–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç** (Redis ping: True)  
‚úÖ **–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è:**
   - Celery (–∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞)
   - –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–µ–∫—Ç–æ—Ä–æ–≤
   - –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ö–æ–∂–µ—Å—Ç–∏

üîÑ **Fallback:** –ï—Å–ª–∏ Redis —É–ø–∞–¥—ë—Ç, —Å–∏—Å—Ç–µ–º–∞ –ø—Ä–æ–¥–æ–ª–∂–∏—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –≤ —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–º —Ä–µ–∂–∏–º–µ

---

**–î–∞—Ç–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏:** 10 –æ–∫—Ç—è–±—Ä—è 2025  
**–°—Ç–∞—Ç—É—Å:** üü¢ –†–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

