# üöÄ –†–£–ö–û–í–û–î–°–¢–í–û –ü–û DOCKER –î–ï–ü–õ–û–Æ

## ‚úÖ –ü–†–û–ï–ö–¢ –ì–û–¢–û–í –ö DOCKER –î–ï–ü–õ–û–Æ

–í—Å–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã. –ü—Ä–æ–µ–∫—Ç –≥–æ—Ç–æ–≤ –∫ –∑–∞–ø—É—Å–∫—É –≤ Docker.

---

## üîß –ß–¢–û –ë–´–õ–û –ò–°–ü–†–ê–í–õ–ï–ù–û

### 1. ‚úÖ –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
- SECRET_KEY —á–∏—Ç–∞–µ—Ç—Å—è –∏–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –æ–∫—Ä—É–∂–µ–Ω–∏—è
- DEBUG –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ—Ç—Å—è —á–µ—Ä–µ–∑ env (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é False)
- ALLOWED_HOSTS –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ env
- .env –¥–æ–±–∞–≤–ª–µ–Ω –≤ .gitignore

### 2. ‚úÖ –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ DATABASE_URL (–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç)
- Fallback –Ω–∞ POSTGRES_* –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
- Health checks –¥–ª—è –æ–∂–∏–¥–∞–Ω–∏—è –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ –ë–î

### 3. ‚úÖ Redis/Celery
- CELERY_BROKER_URL –∏–∑ env
- –ê–≤—Ç–æ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ Redis host –∏–∑ broker URL
- Graceful degradation –µ—Å–ª–∏ Redis –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω

### 4. ‚úÖ –°—Ç–∞—Ç–∏–∫–∞ –∏ –º–µ–¥–∏–∞
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π collectstatic –≤ entrypoint
- –ü–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω—ã–µ volumes –¥–ª—è media/static
- –°–æ–∑–¥–∞–Ω–∏–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π –≤ Dockerfile

### 5. ‚úÖ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
- entrypoint.sh –¥–ª—è –º–∏–≥—Ä–∞—Ü–∏–π –∏ setup
- –û–∂–∏–¥–∞–Ω–∏–µ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ –ë–î (netcat)
- –ê–≤—Ç–æ—Å–æ–∑–¥–∞–Ω–∏–µ –Ω—É–∂–Ω—ã—Ö –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π

### 6. ‚úÖ –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
- Flower –¥–ª—è Celery (–ø–æ—Ä—Ç 5555)
- Health checks –¥–ª—è –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ

---

## üìã –ò–ù–°–¢–†–£–ö–¶–ò–Ø –ü–û –î–ï–ü–õ–û–Æ

### –®–ê–ì 1: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è

#### 1.1 –°–æ–∑–¥–∞–π—Ç–µ .env —Ñ–∞–π–ª:
```bash
cp env.template .env
```

#### 1.2 –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ .env (–í–ê–ñ–ù–û!):
```env
# –°–≥–µ–Ω–µ—Ä–∏—Ä—É–π—Ç–µ –Ω–æ–≤—ã–π SECRET_KEY:
# python -c "from django.core.management.utils import get_random_secret_key; print(get_random_secret_key())"
SECRET_KEY=–≤–∞—à-—É–Ω–∏–∫–∞–ª—å–Ω—ã–π-—Å–µ–∫—Ä–µ—Ç–Ω—ã–π-–∫–ª—é—á-–∑–¥–µ—Å—å

DEBUG=False

# –î–æ–±–∞–≤—å—Ç–µ –≤–∞—à –¥–æ–º–µ–Ω
ALLOWED_HOSTS=localhost,127.0.0.1,your-production-domain.com

# PostgreSQL (–∏–∑–º–µ–Ω–∏—Ç–µ –ø–∞—Ä–æ–ª—å!)
POSTGRES_DB=plagiarism_db
POSTGRES_USER=postgres
POSTGRES_PASSWORD=–≤–∞—à-–Ω–∞–¥—ë–∂–Ω—ã–π-–ø–∞—Ä–æ–ª—å-–∑–¥–µ—Å—å

# DATABASE_URL –±—É–¥–µ—Ç —Å–æ–±—Ä–∞–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ docker-compose
DATABASE_URL=postgres://postgres:–≤–∞—à-–ø–∞—Ä–æ–ª—å@db:5432/plagiarism_db

# Redis (–æ—Å—Ç–∞–≤–∏—Ç—å –∫–∞–∫ –µ—Å—Ç—å –¥–ª—è Docker)
CELERY_BROKER_URL=redis://redis:6379/0
```

---

### –®–ê–ì 2: –°–±–æ—Ä–∫–∞ –∏ –∑–∞–ø—É—Å–∫

```bash
# –°–±–æ—Ä–∫–∞ –æ–±—Ä–∞–∑–æ–≤
docker compose build

# –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
docker compose up -d

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞
docker compose ps
```

–î–æ–ª–∂–Ω—ã –±—ã—Ç—å running:
- `postgres_db` (PostgreSQL + pgvector)
- `redis`
- `django_web` (Django/Gunicorn)
- `celery_worker` (–æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤)
- `flower_monitor` (–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥)

---

### –®–ê–ì 3: –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è

#### 3.1 –°–æ–∑–¥–∞—Ç—å —Å—É–ø–µ—Ä–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:
```bash
docker compose exec web python manage.py createsuperuser
```

#### 3.2 (–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –ó–∞–≥—Ä—É–∑–∏—Ç—å –Ω–∞—á–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:
```bash
docker compose exec web python manage.py shell -c "from documents.models import Status, Type; Status.objects.get_or_create(id=1, defaults={'name':'–ù–∞ –ø—Ä–æ–≤–µ—Ä–∫–µ','html_clase':'queue'}); Type.objects.get_or_create(name='–∫—É—Ä—Å–∞—á')"
```

---

### –®–ê–ì 4: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏

#### 4.1 –û—Ç–∫—Ä–æ–π—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ:
- **–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:** http://localhost:8080
- **Admin:** http://localhost:8080/admin/
- **Flower:** http://localhost:5555

#### 4.2 –¢–µ—Å—Ç –∑–∞–≥—Ä—É–∑–∫–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞:
1. –í–æ–π–¥–∏—Ç–µ –≤ –∫–∞–±–∏–Ω–µ—Ç
2. –ó–∞–≥—Ä—É–∑–∏—Ç–µ PDF —Ñ–∞–π–ª
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤ Flower —á—Ç–æ –∑–∞–¥–∞—á–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è
4. –î–æ–∫—É–º–µ–Ω—Ç –¥–æ–ª–∂–µ–Ω –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å—Å—è –∑–∞ 10-30 —Å–µ–∫

#### 4.3 –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏:
```bash
# –õ–æ–≥–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
docker compose logs -f web

# –õ–æ–≥–∏ Celery
docker compose logs -f celery

# –õ–æ–≥–∏ –ë–î
docker compose logs -f db
```

---

## üêõ –†–ï–®–ï–ù–ò–ï –ü–†–û–ë–õ–ï–ú

### –ü—Ä–æ–±–ª–µ–º–∞: –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –Ω–µ —Å—Ç–∞—Ä—Ç—É—é—Ç
```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏
docker compose logs

# –ü–µ—Ä–µ—Å–æ–±–µ—Ä–∏—Ç–µ —Å –Ω—É–ª—è
docker compose down -v
docker compose build --no-cache
docker compose up -d
```

### –ü—Ä–æ–±–ª–µ–º–∞: –ë–î –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞
```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –ë–î –∑–∞–ø—É—â–µ–Ω–∞
docker compose ps db

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏
docker compose logs db

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ
docker compose restart db web
```

### –ü—Ä–æ–±–ª–µ–º–∞: Celery –Ω–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∑–∞–¥–∞—á–∏
```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Redis
docker compose exec redis redis-cli ping

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ worker
docker compose logs celery

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ
docker compose restart celery
```

### –ü—Ä–æ–±–ª–µ–º–∞: –°—Ç–∞—Ç–∏–∫–∞ –Ω–µ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è
```bash
# –ü–µ—Ä–µ—Å–æ–±–µ—Ä–∏—Ç–µ —Å—Ç–∞—Ç–∏–∫—É –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ
docker compose exec web python manage.py collectstatic --clear --noinput

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ volume
docker volume ls | grep static
```

### –ü—Ä–æ–±–ª–µ–º–∞: Media —Ñ–∞–π–ª—ã –ø—Ä–æ–ø–∞–¥–∞—é—Ç
```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ volume
docker volume ls | grep media

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞
docker compose exec web ls -la /app/Folder/media/
```

---

## üìä –ú–û–ù–ò–¢–û–†–ò–ù–ì –ü–†–û–î–ê–ö–®–ï–ù–ê

### Flower Dashboard:
```
http://your-server:5555
```
–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç:
- –ê–∫—Ç–∏–≤–Ω—ã–µ –∑–∞–¥–∞—á–∏
- Success/Failure rate
- –í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤–æ—Ä–∫–µ—Ä–æ–≤

### –õ–æ–≥–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏:
```bash
docker compose logs -f --tail=100
```

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤:
```bash
docker stats
```

---

## üîí –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–¨ –î–õ–Ø –ü–†–û–î–ê–ö–®–ï–ù–ê

### 1. –ò–∑–º–µ–Ω–∏—Ç–µ –ø–∞—Ä–æ–ª–∏:
- –°–≥–µ–Ω–µ—Ä–∏—Ä—É–π—Ç–µ –Ω–æ–≤—ã–π SECRET_KEY
- –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —Å–∏–ª—å–Ω—ã–π –ø–∞—Ä–æ–ª—å –ë–î
- –ù–µ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –¥–µ—Ñ–æ–ª—Ç–Ω—ã–µ –∫—Ä–µ–¥—ã

### 2. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ HTTPS:
```yaml
# –î–æ–±–∞–≤—å—Ç–µ nginx –≤ docker-compose.yml
nginx:
  image: nginx:alpine
  ports:
    - "80:80"
    - "443:443"
  volumes:
    - ./nginx.conf:/etc/nginx/nginx.conf
    - ./ssl:/etc/nginx/ssl
```

### 3. –û–≥—Ä–∞–Ω–∏—á—å—Ç–µ –¥–æ—Å—Ç—É–ø:
- Flower —Ç—Ä–µ–±—É–µ—Ç –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é
- –ó–∞–∫—Ä–æ–π—Ç–µ –ø–æ—Ä—Ç—ã –ë–î/Redis —Å–Ω–∞—Ä—É–∂–∏
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ firewall

### 4. Backup:
```bash
# Backup –ë–î
docker compose exec db pg_dump -U postgres plagiarism_db > backup.sql

# Backup volumes
docker run --rm -v ad_media_files:/data -v $(pwd):/backup alpine tar czf /backup/media_backup.tar.gz /data
```

---

## üéØ CHECKLIST –ü–ï–†–ï–î –î–ï–ü–õ–û–ï–ú

- [ ] .env —Ñ–∞–π–ª —Å–æ–∑–¥–∞–Ω –∏ –∑–∞–ø–æ–ª–Ω–µ–Ω
- [ ] SECRET_KEY —É–Ω–∏–∫–∞–ª—å–Ω—ã–π
- [ ] DEBUG=False
- [ ] ALLOWED_HOSTS —Å–æ–¥–µ—Ä–∂–∏—Ç –≤–∞—à –¥–æ–º–µ–Ω
- [ ] –ü–∞—Ä–æ–ª–∏ –ë–î –∏–∑–º–µ–Ω–µ–Ω—ã —Å –¥–µ—Ñ–æ–ª—Ç–Ω—ã—Ö
- [ ] docker compose build –∑–∞–≤–µ—Ä—à–∏–ª—Å—è —É—Å–ø–µ—à–Ω–æ
- [ ] docker compose up -d –∑–∞–ø—É—Å—Ç–∏–ª –≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã
- [ ] –ú–∏–≥—Ä–∞—Ü–∏–∏ –ø—Ä–∏–º–µ–Ω–µ–Ω—ã
- [ ] –°—É–ø–µ—Ä–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–æ–∑–¥–∞–Ω
- [ ] –¢–µ—Å—Ç–æ–≤–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] Flower –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∑–∞–¥–∞—á–∏
- [ ] –õ–æ–≥–∏ –±–µ–∑ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–æ–∫

---

## üìà –ú–ê–°–®–¢–ê–ë–ò–†–û–í–ê–ù–ò–ï

### –£–≤–µ–ª–∏—á–µ–Ω–∏–µ workers:
```yaml
celery:
  deploy:
    replicas: 3  # 3 worker –ø—Ä–æ—Ü–µ—Å—Å–∞
```

### –ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ web:
```bash
docker compose up -d --scale web=3
```

–î–æ–±–∞–≤—å—Ç–µ nginx –∫–∞–∫ load balancer.

---

## üéâ –ò–¢–û–ì

–ü—Ä–æ–µ–∫—Ç **–ü–û–õ–ù–û–°–¢–¨–Æ –ì–û–¢–û–í** –∫ Docker –¥–µ–ø–ª–æ—é —Å:
- ‚úÖ –ë–µ–∑–æ–ø–∞—Å–Ω—ã–º–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ —á–µ—Ä–µ–∑ env
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º–∏ –º–∏–≥—Ä–∞—Ü–∏—è–º–∏
- ‚úÖ –ü–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
- ‚úÖ –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–æ–π
- ‚úÖ –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–æ–º —á–µ—Ä–µ–∑ Flower
- ‚úÖ Health checks –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤

–°–ª–µ–¥—É–π—Ç–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º –≤—ã—à–µ –¥–ª—è –¥–µ–ø–ª–æ—è!
